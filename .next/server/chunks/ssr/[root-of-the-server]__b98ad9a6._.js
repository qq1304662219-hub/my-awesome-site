module.exports=[58789,(a,b,c)=>{"use strict";b.exports=a.r(7507).vendored.contexts.HooksClientContext},20096,(a,b,c)=>{"use strict";b.exports=a.r(7507).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},7507,(a,b,c)=>{"use strict";b.exports=a.r(18622)},66367,(a,b,c)=>{"use strict";b.exports=a.r(7507).vendored["react-ssr"].ReactJsxRuntime},40130,(a,b,c)=>{"use strict";b.exports=a.r(7507).vendored["react-ssr"].React},60452,(a,b,c)=>{"use strict";b.exports=a.r(7507).vendored.contexts.AppRouterContext},61153,(a,b,c)=>{"use strict";b.exports=a.r(7507).vendored["react-ssr"].ReactDOM},11537,a=>{"use strict";let b=(0,a.i(69454).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],11537)},60763,a=>{"use strict";var b=a.i(66367),c=a.i(40130),d=a.i(98849),e=a.i(81475),f=a.i(86642),g=a.i(50179),h=a.i(68767),i=a.i(11537),j=a.i(69454);let k=(0,j.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),l=(0,j.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),m=(0,j.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var n=a.i(63817),o=a.i(78792);let p=(0,n.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),q=c.forwardRef(({className:a,variant:c,...d},e)=>(0,b.jsx)("div",{ref:e,role:"alert",className:(0,o.cn)(p({variant:c}),a),...d}));q.displayName="Alert";let r=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("h5",{ref:d,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",a),...c}));r.displayName="AlertTitle";let s=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",a),...c}));function t({userId:a,onUploadSuccess:d}){let[j,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),x=async()=>{if(j&&a){u(!0),w(null);try{let b=j.name.split(".").pop(),c=`${a}/${Date.now()}.${b}`,{error:f}=await e.supabase.storage.from("uploads").upload(c,j);if(f)throw f;let{data:{publicUrl:g}}=e.supabase.storage.from("uploads").getPublicUrl(c),{error:h}=await e.supabase.from("videos").insert({title:o||j.name,url:g,user_id:a});if(h)throw h;w({type:"success",text:"上传成功！"}),n(null),p("");let i=document.getElementById("picture");i&&(i.value=""),d&&d()}catch(a){console.error("Upload error:",a),w({type:"error",text:a.message||"上传失败，请重试"})}finally{u(!1)}}};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"title",className:"text-gray-300",children:"标题"}),(0,b.jsx)(g.Input,{id:"title",value:o,onChange:a=>p(a.target.value),placeholder:"给你的作品起个名字",className:"bg-black/20 border-white/10 text-white"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"picture",className:"text-gray-300",children:"选择文件"}),(0,b.jsx)(g.Input,{id:"picture",type:"file",onChange:a=>{a.target.files&&a.target.files.length>0&&(n(a.target.files[0]),o||p(a.target.files[0].name.replace(/\.[^/.]+$/,"")))},className:"bg-black/20 border-white/10 text-white file:text-white file:bg-blue-600 file:border-0 file:rounded-md file:mr-4 file:px-2 file:py-1 hover:file:bg-blue-700",accept:"image/*,video/*"})]}),v&&(0,b.jsxs)(q,{variant:"error"===v.type?"destructive":"default",className:"success"===v.type?"border-green-500/50 text-green-500 bg-green-500/10":"",children:["success"===v.type?(0,b.jsx)(l,{className:"h-4 w-4"}):(0,b.jsx)(m,{className:"h-4 w-4"}),(0,b.jsx)(r,{children:"success"===v.type?"成功":"错误"}),(0,b.jsx)(s,{children:v.text})]}),(0,b.jsx)(f.Button,{onClick:x,disabled:!j||t,className:"w-full bg-blue-600 hover:bg-blue-700",children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k,{className:"mr-2 h-4 w-4 animate-spin"}),"正在上传..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Upload,{className:"mr-2 h-4 w-4"}),"开始上传"]})})]})}s.displayName="AlertDescription";var u=a.i(33075),v=a.i(26999);let w=(0,j.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),x=(0,j.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),y=(0,j.default)("film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);function z(){let[a,g]=(0,c.useState)(null),[h,i]=(0,c.useState)([]),j=(0,d.useRouter)(),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{let{data:{user:a}}=await e.supabase.auth.getUser();a?(g(a),o(a.id)):j.push("/auth"),l(!1)})()},[j]);let o=async a=>{n(!0);let{data:b,error:c}=await e.supabase.from("videos").select("*").eq("user_id",a).order("created_at",{ascending:!1});!c&&b&&i(b),n(!1)},p=async()=>{await e.supabase.auth.signOut(),j.push("/")};return k?(0,b.jsx)("div",{className:"min-h-screen bg-[#020817] flex items-center justify-center text-white",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):a?(0,b.jsxs)("div",{className:"min-h-screen bg-[#020817] text-white",children:[(0,b.jsx)("nav",{className:"border-b border-white/10 bg-black/20 backdrop-blur-md sticky top-0 z-50",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Video,{className:"h-6 w-6 text-blue-500"}),(0,b.jsx)("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"AI Vision 面板"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("span",{className:"text-sm text-gray-400 hidden md:inline",children:a.email}),(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:p,className:"text-gray-400 hover:text-white hover:bg-white/10",children:[(0,b.jsx)(w,{className:"h-4 w-4 mr-2"}),"退出"]})]})]})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(u.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm sticky top-24",children:[(0,b.jsx)(u.CardHeader,{children:(0,b.jsxs)(u.CardTitle,{className:"text-white flex items-center gap-2",children:[(0,b.jsx)(x,{className:"h-5 w-5 text-blue-500"}),"上传新作品"]})}),(0,b.jsx)(u.CardContent,{children:(0,b.jsx)(t,{userId:a.id,onUploadSuccess:()=>o(a.id)})})]})}),(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(y,{className:"h-6 w-6 text-purple-500"}),"我的作品库"]}),(0,b.jsxs)("span",{className:"text-sm text-gray-400",children:["共 ",h.length," 个文件"]})]}),m?(0,b.jsx)("div",{className:"text-center py-12 text-gray-500",children:"加载中..."}):0===h.length?(0,b.jsxs)("div",{className:"text-center py-12 bg-white/5 rounded-xl border border-white/10 border-dashed",children:[(0,b.jsx)("p",{className:"text-gray-400 mb-2",children:"暂无上传作品"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"快去左侧上传你的第一个 AI 视频吧！"})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map(a=>(0,b.jsxs)("div",{className:"group relative bg-white/5 rounded-xl overflow-hidden border border-white/10 hover:border-blue-500/50 transition-all",children:[(0,b.jsx)("div",{className:"aspect-video relative bg-black/50",children:a.url.match(/\.(mp4|webm|ogg)$/i)?(0,b.jsx)("video",{src:a.url,controls:!0,className:"w-full h-full object-cover"}):(0,b.jsx)("img",{src:a.url,alt:a.title,className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("h3",{className:"font-medium truncate text-white",title:a.title,children:a.title}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(a.created_at).toLocaleDateString()})]})]},a.id))})]})]})})]}):null}a.s(["default",()=>z],60763)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b98ad9a6._.js.map