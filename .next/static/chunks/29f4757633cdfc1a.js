(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3300,e=>{"use strict";let t=(0,e.i(45869).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],3300)},18171,e=>{"use strict";var t=e.i(31968),s=e.i(49417),a=e.i(93961),l=e.i(25695),r=e.i(79852),i=e.i(34470),d=e.i(64736),c=e.i(3300),n=e.i(45869);let h=(0,n.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),o=(0,n.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),u=(0,n.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var x=e.i(92771),m=e.i(66567);let p=(0,x.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),g=s.forwardRef(({className:e,variant:s,...a},l)=>(0,t.jsx)("div",{ref:l,role:"alert",className:(0,m.cn)(p({variant:s}),e),...a}));g.displayName="Alert";let b=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h5",{ref:a,className:(0,m.cn)("mb-1 font-medium leading-none tracking-tight",e),...s}));b.displayName="AlertTitle";let f=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,m.cn)("text-sm [&_p]:leading-relaxed",e),...s}));function y({userId:e,onUploadSuccess:a}){let[n,x]=(0,s.useState)(null),[m,p]=(0,s.useState)(""),[y,v]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),w=async()=>{if(n&&e){v(!0),N(null);try{let t=n.name.split(".").pop(),s=`${e}/${Date.now()}.${t}`,{error:r}=await l.supabase.storage.from("uploads").upload(s,n);if(r)throw r;let{data:{publicUrl:i}}=l.supabase.storage.from("uploads").getPublicUrl(s),{error:d}=await l.supabase.from("videos").insert({title:m||n.name,url:i,user_id:e});if(d)throw d;N({type:"success",text:"上传成功！"}),x(null),p("");let c=document.getElementById("picture");c&&(c.value=""),a&&a()}catch(e){console.error("Upload error:",e),N({type:"error",text:e.message||"上传失败，请重试"})}finally{v(!1)}}};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"title",className:"text-gray-300",children:"标题"}),(0,t.jsx)(i.Input,{id:"title",value:m,onChange:e=>p(e.target.value),placeholder:"给你的作品起个名字",className:"bg-black/20 border-white/10 text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.Label,{htmlFor:"picture",className:"text-gray-300",children:"选择文件"}),(0,t.jsx)(i.Input,{id:"picture",type:"file",onChange:e=>{e.target.files&&e.target.files.length>0&&(x(e.target.files[0]),m||p(e.target.files[0].name.replace(/\.[^/.]+$/,"")))},className:"bg-black/20 border-white/10 text-white file:text-white file:bg-blue-600 file:border-0 file:rounded-md file:mr-4 file:px-2 file:py-1 hover:file:bg-blue-700",accept:"image/*,video/*"})]}),j&&(0,t.jsxs)(g,{variant:"error"===j.type?"destructive":"default",className:"success"===j.type?"border-green-500/50 text-green-500 bg-green-500/10":"",children:["success"===j.type?(0,t.jsx)(o,{className:"h-4 w-4"}):(0,t.jsx)(u,{className:"h-4 w-4"}),(0,t.jsx)(b,{children:"success"===j.type?"成功":"错误"}),(0,t.jsx)(f,{children:j.text})]}),(0,t.jsx)(r.Button,{onClick:w,disabled:!n||y,className:"w-full bg-blue-600 hover:bg-blue-700",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{className:"mr-2 h-4 w-4 animate-spin"}),"正在上传..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Upload,{className:"mr-2 h-4 w-4"}),"开始上传"]})})]})}f.displayName="AlertDescription";var v=e.i(36540),j=e.i(27919);let N=(0,n.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),w=(0,n.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),k=(0,n.default)("film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);function M(){let[e,i]=(0,s.useState)(null),[d,c]=(0,s.useState)([]),n=(0,a.useRouter)(),[h,o]=(0,s.useState)(!0),[u,x]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await l.supabase.auth.getUser();e?(i(e),m(e.id)):n.push("/auth"),o(!1)})()},[n]);let m=async e=>{x(!0);let{data:t,error:s}=await l.supabase.from("videos").select("*").eq("user_id",e).order("created_at",{ascending:!1});!s&&t&&c(t),x(!1)},p=async()=>{await l.supabase.auth.signOut(),n.push("/")};return h?(0,t.jsx)("div",{className:"min-h-screen bg-[#020817] flex items-center justify-center text-white",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-[#020817] text-white",children:[(0,t.jsx)("nav",{className:"border-b border-white/10 bg-black/20 backdrop-blur-md sticky top-0 z-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Video,{className:"h-6 w-6 text-blue-500"}),(0,t.jsx)("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"AI Vision 面板"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:"text-sm text-gray-400 hidden md:inline",children:e.email}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:p,className:"text-gray-400 hover:text-white hover:bg-white/10",children:[(0,t.jsx)(N,{className:"h-4 w-4 mr-2"}),"退出"]})]})]})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(v.Card,{className:"bg-white/5 border-white/10 backdrop-blur-sm sticky top-24",children:[(0,t.jsx)(v.CardHeader,{children:(0,t.jsxs)(v.CardTitle,{className:"text-white flex items-center gap-2",children:[(0,t.jsx)(w,{className:"h-5 w-5 text-blue-500"}),"上传新作品"]})}),(0,t.jsx)(v.CardContent,{children:(0,t.jsx)(y,{userId:e.id,onUploadSuccess:()=>m(e.id)})})]})}),(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(k,{className:"h-6 w-6 text-purple-500"}),"我的作品库"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:["共 ",d.length," 个文件"]})]}),u?(0,t.jsx)("div",{className:"text-center py-12 text-gray-500",children:"加载中..."}):0===d.length?(0,t.jsxs)("div",{className:"text-center py-12 bg-white/5 rounded-xl border border-white/10 border-dashed",children:[(0,t.jsx)("p",{className:"text-gray-400 mb-2",children:"暂无上传作品"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"快去左侧上传你的第一个 AI 视频吧！"})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(e=>(0,t.jsxs)("div",{className:"group relative bg-white/5 rounded-xl overflow-hidden border border-white/10 hover:border-blue-500/50 transition-all",children:[(0,t.jsx)("div",{className:"aspect-video relative bg-black/50",children:e.url.match(/\.(mp4|webm|ogg)$/i)?(0,t.jsx)("video",{src:e.url,controls:!0,className:"w-full h-full object-cover"}):(0,t.jsx)("img",{src:e.url,alt:e.title,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"font-medium truncate text-white",title:e.title,children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleDateString()})]})]},e.id))})]})]})})]}):null}e.s(["default",()=>M],18171)}]);